apiVersion: json.kyverno.io/v1alpha1
kind: Policy
metadata:
  name: test
spec:
  rules:
    - name: pod-no-latest
      match:
        any:
        - resource:
            apiVersion: v1
            kind: Pod
      validate:
        pattern:
          ~(spec.containers[*].image):
            (contains(@,':')): true
            (ends_with(@,':latest')): false
          # spec:
          #   ~containers:
          #     image:
          #       (contains(@, ':')): true
          #       (ends_with($image, ':latest')): false
